---
title: 'Основные настройки'
weight: 4
toc: true
---

# Конфигурация
Podkop можно настраивать через LuCi: Services/podkop

И через файл конфигурации: /etc/config/podkop

# Режимы работы
Есть два режима работы: Proxy и VPN.

## VPN
В этом режиме вы выбираете предварительно настроенный интерфейс. Это может быть Wireguard, AmneziaWG, OpenVPN, OpenConnect и любой другой туннель или VPN. Достаточно настроить только сам туннель или VPN, настройки firewall и зон не обязательны.

## Proxy
В этом режиме сейчас поддерживаются две технологии: VLESS и Shadowsocks.

Доступно два варианта настройки:

- **URL подключения | Connection URL**

Используется для ссылки вида **vless://** и **ss://**. Просто вставьте свою ссылку.

> Если ваша строка не поддерживается, пришлите пример строки (без чувствительных данных) и конфигурацию inbound для XRay или Sing-box в чат, чтобы мы могли воспроизвести и протестировать эту конфигурацию. Также вы можете использовать готовый Outbound.

- **Конфигурация Outbound | Outbound Config**

Если по какой-то причине у вас отсутствует ссылка или ваша ссылка не заработала, вы можете скопировать раздел outbounds вашего конфигурационного файла.

При выбранном режиме Proxy доступна еще одна настройка:

**Shadowsocks UDP over TCP**

UDP over TCP используется для передачи UDP-пакетов в TCP. По-умолчанию для Shadowsocks отключена функция UDP over TCP. Включается с помощью этой галочки. Может быть полезна пользователям Outline.

### Предустановленные списки | Community Lists

Готовые списки для проксирования. Подробнее о них вы можете узнать [здесь](/docs/sections).

### Настройки пользовательских списков доменов

Если вы не хотите использовать готовые списки или какие-то домены отсутствуют в них, вы можете добавлять свои с помощью следующих настроек:

#### Тип пользовательского списка доменов | User Domain List Type

Позволяет добавить недостающие домены.

Доступно два режима добавления:

- **Текстовый список | Text List**

  Удобен в случае, если у вас много доменов или вам нужно скопировать их из файла. В качестве разделителя можно использовать запятую, пробел или указать каждый домен с новой строки. Доступны комментарии, при использовании символов // перед текстом.

- **Динамический список | Dynamic List**

  Используется для добавления доменов по одному.

Домены указываются в следующем виде:

```
example.com
sub.example.com
```

### Локальные списки доменов | Local Domain Lists

Вы можете поместить список доменов в файл вида file.lst, где каждый домен будет начинаться с новой строки.

### Удаленные списки доменов | Remote Domains Lists

Доступен вариант загрузки списка доменов с GitHub или вашего личного сайта. Необходимо указать полный адрес, с указанием протокола (http:// или https://)

### Пользовательские списки подсетей

Аналогично доменам, вы можете добавить список подсетей.
Подсети указываются в следующем виде:

```
103.21.244.0/22
103.21.244.89
```

Для добавления подсетей доступны следующие опции:

#### Тип пользовательского списка подсетей | User Subnet List Type

Позволяет добавить недостающие подсети.

Доступно два режима добавления:

- **Текстовый список | Text List**

  Удобен в случае, если у вас много подсетей или вам нужно скопировать их из файла. В качестве разделителя можно использовать запятую, пробел или указать каждую подсеть с новой строки. Доступны комментарии, при использовании символов // перед текстом.

- **Динамический список | Dynamic List**

  Используется для добавления подсетей или IP адресов по одному.

#### Удаленные списки подсетей | Remote Subnet Lists

Доступен вариант загрузки списка подсетей с GitHub или вашего личного сайта. Необходимо указать CIDR или одиночный IP. Необходимо указать полный адрес, с указанием протокола (http:// или https://)

### Исключение/направление всего трафика в туннель

Для того чтобы исключить или направить трафик с конкретного устройства в туннель предусмотрены следующие настройки:

#### Принудительное прокси IP | IP for full redirection

Направляет весь трафик с конкретного устройства в туннель. Для этого требуется указать IP устройства.

Чтобы узнать IP устройства, вам нужно зайти в веб-интерфейс роутера и перейти в Status -> Overview или Network -> DHCP and DNS -> Static Leases. В разделе Active DHCP Leases отображаются выданные вашим устройствам IP. При необходимости вы можете сделать их статическими нажав кнопку **Set Static** или **Add** и добавить необходимое устройство.

#### Исключение прокси IP | IP for exclusion

Если вам требуется исключить устройство из проксирования, то вы можете указать его IP в данной опции.

### Включить смешанный режим | Mixed enable

Позволяет поднять на роутере socks-прокси и направлять весь трафик с определенного приложения на роутере или в локальной сети, в прокси.
Вы можете, к примеру, настроить в браузере на компьютере прокси и тогда весь трафик с него отправится в туннель.

##  Дополнительные настройки | Additional Settings

### Включить Yacd | Yacd enable

Yacd (Clash API) представляет собой дополнительную веб-панель, в которой вы можете увидеть уходят ли соединения в туннель, потребление памяти и правила, используемые Sing-box. Подробнее [здесь](/docs/yacd).

### Исключить NTP | Exclude NTP

Позволяет исключить направление трафика NTP-протокола в туннель/proxy. Может быть необходимо, при использовании умных колонок от Яндекс и в других ситуациях, если у вас остается много незакрытых соединений и из-за этого растет потребление оперативной памяти роутера.

### Отключить QUIC | QUIC disable

Позволяет отключить использование протокола QUIC. Может быть полезно при проблемах с YouTube на Android-устройствах.

### Частота обновления списков | List Update Frequency

С какой частотой будут обновляться предустановленные списки доменов.

### Настройки DNS

При использовании podkop, вам необходимо настроить DNS-сервер для роутера здесь. 

#### Тип DNS протокола | DNS Protocol Type

Позволяет выбрать тип DNS-протокола: DoH, DoT или UDP.

#### DNS сервер | DNS Server

Позволяет выбрать DNS сервер или указать свой.

#### Путь к файлу кэша | Cache File Path

Место где будет храниться кэш от DNS-записей и предустановленные списки. По умолчанию хранится в **/tmp** (раздел в RAM).

Вы можете хранить его в NAND, но это уже на ваш страх и риск. Также можно вынести на внешний накопитель.

#### Перезапись TTL для DNS | DNS Rewrite TTL

Время в секундах, в течение которого DNS-запись о FakeIP будет храниться в кэше устройств. Рекомендуется использовать дефолтное значение.

Если файл кэша хранится в RAM, то после перезагрузки роутера "старые" зарезолвенные фейковые IP-адреса останутся на устройстве и не будут работать с "новым" кэшем. Именно поэтому TTL в 1 минуту - оптимальное значение. И после ребута роутера они пропадут с ваших устройств, и DNS-запросы к роутеру будут ходить не слишком часто.

### Source Network interface

Позволяет выбрать интерфейс(ы), с которого(ых) трафик должен идти в прокси. Следует изменить, если у вас локальная сеть на нестандартном **br-lan** или если вам необходимо перенаправление трафика с дополнительного интерфейса, например **wg0**.